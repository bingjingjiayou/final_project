---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 


```{r}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("DESeq2")
```
```{r}
browseVignettes("DESeq2")
```

```{r}
pasAnno <- read.table(file = '~/exp_seq.tsv', sep = '\t', header = TRUE) 
```


```{r}
pasBnno <- read.table(file = '~/donor.tsv', sep = '\t', header = TRUE)
```

```{r}
library(readxl)
pasAnno1<-subset(pasAnno,select = c(1,8,10))
pasBnno1<-subset(pasBnno,select = c(1,5,9,21))
```
```{r}
head(pasAnno1)
```

Change raw_ read_ The data type of the count column is int
```{r}
write.csv(pasAnno1,file="~/drawdata.csv",quote = F)
```

```{r}
data <- read.table("/Users/bingjing/Desktop/drawdata.csv",header = TRUE, na.strings = c("NA"), sep = ',')
class(data$raw_read_count)
data$raw_read_count <- as.integer(data$raw_read_count)
class(data$raw_read_count)
write.csv(data, file = "~/rawdata.csv", row.names = F, quote = F, na="0")
```




```{r}
pasAnno2<-read.csv("~/rawdata.csv",row.names = 1)
```
```{r}
head(pasAnno2)
```

Change data format (length data to width data)
```{r}
require(tidyverse)
dat <-  pasAnno2 %>% 
  group_by(icgc_donor_id) %>%
  mutate(index = row_number()) %>%
  pivot_wider(names_from = icgc_donor_id, 
              values_from = raw_read_count) %>%
  select(-index)
pasAnno3<-dat
```


```{r}
require(tidyverse)
dat <-  pasAnno2  
pasAnno5<-  pivot_wider(pasAnno2,names_from = icgc_donor_id, 
              values_from = raw_read_count) 

```
```{r}
head(pasAnno5)
```

```{r}
pasAnno4<- filter(pasAnno3, pasAnno3$DO50855 !='NA') 
```

```{r}
write.csv(pasAnno4, file = "~/rawdata1.csv", row.names = F, quote = F, na="0")
```


```{r}
mycounts<-read.csv ("~/rawdata1.csv",row.names = 1)
```

```{r}
colnames(mycounts) == pasBnno1$icgc_donor_id
```

```{r}
df_x=read.csv("filtered_new.csv",stringsAsFactors = F)
```
```{r}

```

```{r}
save(pasAnno5,file="~/drawdata2.rdata")
```



